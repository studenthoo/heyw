{% from "helper.html" import print_flashes %}
{% from "helper.html" import print_combined_errors %}
{% from "helper.html" import mark_errors %}

{% extends 'new/public.html' %}

{% block topfile %}
    <link rel="shortcut icon" href="{{url_for('static', filename='images/bitbug_favicon.ico')}}" />
  <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/ZK_last4/public.css')}}" />
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/ZK_last4/sub.css')}}" />
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/ZK_last4/iconfont.css')}}" />
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/ZK_last4/calendar.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/public.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/sub.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/iconfont.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='plugins/iCheck/skins/minimal/grey.css')}}" />
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/calendar.css')}}" />

<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/style.css')}}"/>

    <script type="text/javascript" src="{{url_for('static', filename='js/jquery-1.7.2.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/Feffects.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='plugins/iCheck/icheck.min.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/jq-datepicker.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/jquery.nicescroll.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/echarts.min.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/jqmeter.min.js')}}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='js/public.js')}}"></script>

<script src="{{ url_for('static', filename='js/3rdparty/jquery.autocomplete-1.2.21.min.js', ver=dir_hash) }}" type="text/javascript" charset="utf-8"></script>
    {% endblock topfile %}

{% block rightcontent %}

<!--提示框-->
<style>
    .prompt-box{    z-index: 99998;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, .6);
        display: none;
    }
    .alert-div{
        width: 400px;
        height: 240px;
        background: white;
        margin: 0 auto;
        margin-top: 10%;
        position: relative;
    }
    .alert-div-nav{
        height:40px;
    }

    .alert-div-content h3{height: 40px;
        line-height: 40px;
        text-align: center;
        margin-top: 35px;
    }
    .alert-btn{height: 40px;
        text-align: center;
        position: absolute;
        bottom: 35px;
        width: 100%;
    }
    .alert-btn div{display: inline-block; }
    .alert-btn  h3{
        height:40px;
        width: 100%;
        /*padding: 0 30px;*/
        line-height: 40px;
    }

    .alert-btn-yes{background: #00b5b8;
        color: white;
        width:100px;
    }
    .hover-red:hover{color: white;
        background: #ff6376;
    }
</style>

<div class="prompt-box">
    <div class="alert-div">
        <div class="alert-div-nav">

        </div>
        <div class="alert-div-content">
            <h3></h3>
        </div>
        <div class="alert-btn">

            <div class="alert-btn-yes hover-red">
                <h3>确定</h3>
            </div>
        </div>
    </div>
</div>
<script>
    $('.prompt-box .alert-btn-yes').on('click',function () {
        $('.prompt-box').css('display','none')
    })
</script>






            <div class="f-l title">
            	<h1 class="f-l c-grayblue"> 数据管理 </h1>
            	<span class="f-l c-gray"> Welcome back, {{request.cookies.username}} </span>
            </div>
            
			      <div class="f-l sub-title bgc-white">
			      	<a href="{{ url_for('hyperai.views.index') }}" class="f-l c-gray c-aqua-h"><span class="f-l"> Home   </span><em class="f-l c-gray"> / </em></a>
			      	<a href="{{ url_for('hyperai.views.datasets') }}" class="f-l c-gray c-aqua-h"><span class="f-l"> 数据管理 </span><em class="f-l c-gray"> / </em></a>
			      	<a href="#" class="f-l c-gray c-aqua-h"><span class="f-l"> 新建数据集</span><em class="f-l c-gray"> / </em></a>
			      </div>

            <div class="f-l title bgc-white">
            	<h3 class="f-l c-grayblue newdata-name">新建数据集</h3>
            </div>
            
            <div class="f-l lis-n bgc-white">
				<form action="{{url_for('hyperai.dataset.generic.views.create', extension_id=extension_id)}}" enctype="multipart/form-data" method="post" class="form_all">
	            <div class="c-box">
		            <div class="l-box w-68">
			            <div class="f-l title bgc-white">
			            	<h2 class="f-l c-grayblue"> 数据集属性  </h2>
			            </div>
			            <div class="c-box bdr lis-nl">
                        <span class="f-l btn-1 bgc-Aqua c-white"> 图像文件 </span>
			              <div class="c-box m-t15">
			              	<h3 class="f-l w-30 c-grayblue"> 数据集名称: </h3>{{ form.dataset_name(class='f-l input-info bdr w-65 dataset-name',placeholder="user-data-D001") }}
			              </div>
			              <div class="c-box m-t15">
			              	<h3 class="f-l c-grayblue w-30"> 概述: </h3>
			              	{{form.dataset_desc(class='f-l input-info bdr w-65 input-intro')}}
			              </div>
                            <div class="c-box m-t15 url_verify_alert" style="display: none;">
                                <h3 class="f-l c-grayblue w-30"></h3>
                                <p style="width:30%;border: none;color:red;" class='f-l input-info w-75 input-intro'>输入路径不存在</p>
                            </div>
                    <div class="c-box m-t15"></div>
			               {{ extension_html|safe }}

	            </div>
	            <input class="f-l btn-8 m-t15 m-r15 c-grayblue bgc-red-h c-white-h bgc-gray-b sbmit" type="reset" name="" id="" value="取消" style="width: 130px;outline: none" />

 <input class="f-l btn-8 m-t15 m-r15 c-white bgc-Aqua bgc-red-h sbmit  click-none" type="button" name="" id="" value="提交" style="width: 130px;outline: none" />
            </div>
					 <div class="r-box w-30">
			            <div class="f-l title bgc-white">
			            	<h2 class="f-l c-grayblue"> 数据集属性  </h2>
			            </div>
			            <div class="c-box bdr lis-nr">
			            	<div class="c-box z-idx-6">
			            		<h3 class="f-l w-50 c-grayblue"> 数据库类型: </h3>
							 				<div class="f-l w-50 div-select">
								 				<div class="f-l select-box sub-select"> {{ form.dsopts_backend(class='f-l select-box bdr sub-select') }}
												</div>
											</div>
			            	</div>
			            	<div class="c-box m-t15 z-idx-5">
			            		<h3 class="f-l w-50 c-grayblue"> 特征编码格式: </h3>
							 				<div class="f-l w-50 div-select">
								 				<div class="f-l select-box sub-select">

												{{form.dsopts_feature_encoding(class='f-l select-box bdr sub-select')}}
												</div>
											</div>
			            	</div>
			            	<div class="c-box m-t15 z-idx-4">
			            		<h3 class="f-l w-50 c-grayblue"> 标签编码格式: </h3>
							 				<div class="f-l w-50 div-select">
								 				<div class="f-l select-box sub-select">

												{{form.dsopts_label_encoding(class='f-l select-box bdr sub-select')}}
												</div>
											</div>
			            	</div>
			            	<div class="c-box m-t15 z-idx-3">
			            		<h3 class="f-l w-50 c-grayblue"> 编码器批量大小: </h3>{{ form.dsopts_batch_size(class='f-l bdr w-42 input-info') }}

			            	</div>
			            	<div class="c-box m-t15 z-idx-2">
			            		<h3 class="f-l w-50 c-grayblue"> 编码器线程数: </h3>{{ form.dsopts_num_threads(class='f-l bdr w-42 input-info') }}

			            	</div>
			            	<div class="c-box m-t15 z-idx-1">
			            		<h3 class="f-l w-50 c-grayblue"> 强制相同形状: </h3>
							 				<div class="f-l w-50 div-select">
								 				<div class="f-l select-box sub-select"> {{ form.dsopts_force_same_shape(class='f-l select-box bdr sub-select') }}


												</div>
											</div>
			            	</div>
			            	<div class="c-box m-t15 z-idx-0">
			            		<h3 class="f-l w-50 c-grayblue"> 组名: </h3>
	{{ form.group_name(class='f-l bdr w-42 input-info')}}
			            	</div>
			            </div>
					 </div>
				</div>
	     </form>
				<script>




                    console.log('------scence-----',$('.form_all').attr('action').slice(25))


                    var flag = true

                    $('.click-none').on('click',function () {
//						console.log()
//							console.log(111)
                        if($('.dataset-name').val() === ''){

                            $('.prompt-box').css('display','block')
                            $('.prompt-box .alert-div-content h3').html('数据集名称不能为空！')

//                            alert('数据集名称不能为空')
                            return false
                        }else if($('.input-intro').val() === ''){
                            $('.prompt-box').css('display','block')
                            $('.prompt-box .alert-div-content h3').html('概述不能为空！')
//                            alert('概述不能为空！')
                            return false
                        }else if($('.form_all').attr('action').slice(25) == 'image-object-detection'){
                            if($('#train_image_folder').val() == ''){

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('训练图像目录不能为空！')

//                                alert('训练图像目录不能为空！')
                                return false
                            }else if($('#train_label_folder').val() == ''){

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('训练标签目录不能为空！')
//                                alert('训练标签目录不能为空！')
                                return false
                            }else if($('#val_image_folder').val() == ''){

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('验证图像目录不能为空！')

                                return false
                            }else if($('#val_label_folder').val() == ''){

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('验证标签目录不能为空！')

                                return false
                            }
                        }else if($('.form_all').attr('action').slice(25) == 'image-segmentation'){

                            if($('#feature_folder').val() == ''){

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('特征图像目录不能为空！')

                                return false
                            }else if($('#label_folder').val() == ''){
                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('标签图像目录不能为空！')

                                return false
                            }else if($('#class_labels_file').val() == ''){

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('类标签不能为空！')

                                return false
                            }

                        }

                        else if($('.form_all').attr('action').slice(25) == 'image-sunnybrook') {
                            if ($('#image_folder').val() == '') {

                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('图片目录不能为空！')


                                return false
                            } else if ($('#contour_folder').val() == '') {
                                $('.prompt-box').css('display','block')
                                $('.prompt-box .alert-div-content h3').html('轮廓目录不能为空！')

                                return false
                            }
                        }

                        if(flag == false){
                            return false
                        }
                        flag = false
                        console.log('===============')
                        $('.form_all').submit()
                        // $(this).attr('disabled','disabled')
                    })
				</script>
				</div>
			{% endblock rightcontent%}